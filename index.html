<html>
<head>
	<title>5e Pickpocketing Calculator</title>
	<script>


		function rand(min, max) {
		  min = Math.ceil(min);
		  max = Math.floor(max);
		  return Math.floor(Math.random() * (max - min) + min); // The maximum is exclusive and the minimum is inclusive
		}

		function complications() {
			theRoll=rand(1,100);

			switch (true){
				case theRoll>=1 && theRoll<=27:
					result="Word gets out that there is a pickpocket active in the area.  For the next 3d4 days, further attempts are at Disadvantage";
					break;
				case theRoll>=28 && theRoll<=35:
					result="Someone saw you, they approach you and ask for a bribe to stay quiet.";
					break;
				case theRoll>=36 && theRoll<=42:
					result="Someone saw you, a description of you is being circulated throughout the town.";
					break;
				case theRoll>=43 && theRoll<=48:
					result="Someone saw you, your whole party is being sought for the crime.";
					break;
				case theRoll>=49 && theRoll<=55:
					result="The local Thieves guild has noticed you and approaches you demanding a tithe of 50%";
					break;
				case theRoll>=56 && theRoll<=61:
					result="Your loot is a single, easily identified item that you can’t fence in this region.";
					break;
				case theRoll>=62 && theRoll<=66:
					result="You were pickpocketed while working.  Roll 1d10, higher means something more dear to you was stolen.";
					break;
				case theRoll>=67 && theRoll<=71:
					result="Target had a pickpocket trap. Make a DC 10 Constitution save or take 3d6 poison damage. Half as much on a save.";
					break;
				case theRoll>=72 && theRoll<=75:
					result="A bounty equal to 10 times your earnings is offered for information about your crime.";
					break;
				case theRoll>=76 && theRoll<=79:
					result="An unknown person witnessed your crime and threatened to call you out to your victim unless you promised to render a service.";
					break;
				case theRoll>=80 && theRoll<=82:
					result="You robbed from someone who was under a local crime lord’s protection, and who now wants revenge.";
					break;
				case theRoll>=83 && theRoll<=85:
					result="Your victim calls in a favor from a guard, doubling the efforts to solve the case.";
					break;
				case theRoll>=86 && theRoll<=89:
					result="Your victim approaches one of your adventuring companions asking about you.";
					break;
				case theRoll>=90 && theRoll<=92:
					result="A paladin or cleric of justice is keeping their eyes peeled for someone matching your description.";
					break;
				case theRoll>=93 && theRoll<=94:
					result="You stole something precious from a beloved figure; everyone in town is looking for you, the thieving scumbag.";
					break;
				case theRoll>=95 && theRoll<=96:
					result="You have snatched an anti-pickpocket token. Make a DC 15 Constitution check or you get an easily noticeable rash over your whole body for 1d4 days.  Guards seeing this rash will recognize what it is.";
					break;
				case theRoll>=97 && theRoll<=98:
					result="The target is pissed and is expending 10 times the value stolen to track you down.";
					break;
				case theRoll==99:
					result="The local Thieves Guild hires assassins to kill you.";
					break;
				case theRoll==100:
					result="Your target hires a group of murder hobo's to track you down and kill you.";
					break;
			}


			return result;

		}



		function rewardCommon() {
			var itemList = [
"Bead of Nourishment",
"Bead of Refreshment",
"Candle of the Deep",
"Perfume of Bewitching",
"Pot of Awakening",
"Potion of climbing",
"Potion of healing",
"Scroll 1st level spell",
"Scroll cantrip",
"Wand of Conducting",
"Wand of Pyrotechnics",
"Wand of Scowls",
"Wand of Smiles",
"Charlatans Die",
"Clockwork Amulet",
"Dark Shard Amulet",
"Ear Horn of Hearing",
"Ersatz Eye",
"Hewards Handy Spice Pouch",
"Horn of Silent Alarm",
"Mystery Key",
"Orb of Direction",
"Orb of Time",
"Perfume of Bewitching",
"Pipe of Smoke Monsters",
"Rope of Mending",
"Ruby of the WarMage",
"Talking Doll",
"Tankard of Sobriety",
"Vial of Holy Water"
				]

			max=itemList.length;

			index=rand(0,max);

			rewardItem=itemList[index];

			return rewardItem;

		}

		function rewardUncommon() {
			var itemList = [
"Scroll - 2nd level spell",
"Scroll 3rd level spell",
"Bottled Breath",
"Dust of Disappearance",
"Dust of Dryness",
"Dust of Sneezing and choking",
"Keoghtom's ointment",
"Oil of slipperiness",
"Philter of Love",
"Potion of animal friendship",
"Potion of fire breathing",
"Potion of greater healing",
"Potion of Hill Giant Strength",
"Potion of Growth",
"Portion of Poison",
"Potion of resistance",
"Potion of WaterBreathing",
"Alchemy Jug",
"Amulet of proof against detection and location",
"Bag of Holding",
"Bag of Tricks",
"Balance of Harmony",
"Balloon Pack",
"Brooch of Shielding",
"Circlet of Blasting",
"Deck of Illusions (# of cards?)",
"Driftglobe",
"Elemental Gem",
"Eyes of Charming",
"Eyes of minute seeing",
"Eyes of the eagle",
"Figuring of wonderous power, silver raven",
"Gem of Brightness",
"Goggles of the night",
"Insignia of Claws",
"Medallion of thoughts",
"Necklace of Adaptation",
"Pearl of Power",
"Periapt of health",
"Periapt of wound closure",
"Pipes of Haunting",
"Pipes of the sewers",
"Ring of Jumping",
"Ring of Mind Shielding",
"Ring of swimming",
"Ring of Warmth",
"Ring of Water Walking",
"Rope of Climbing",
"Sending Stone",
"Spell Gem (obsidian)",
"Spell Gem (Lapis Lazuli)",
"Stone of good luck",
"Stone of Ill luck",
"Wand of Entangle",
"Wand of Magic Detection",
"Wand of Magic Missiles",
"Wand of Secrets",
"Wand of the Warmage +1",
"Wand of Web",
"Dagger +1",
"Dagger of Warning",
"Wind Fan"
				]

			max=itemList.length;

			index=rand(0,max);

			rewardItem=itemList[index];

			return rewardItem;

		}

		function rewardRare() {
			var itemList = [
"Bead of Force",
"Elixir of Health",
"Necklace of Fireballs (one bead)",
"Potion of Clairvoyance",
"Potion of Diminution",
"Potion of Fire Giant Strength",
"Potion of Frost Giant Strength",
"Potion of Stone Giant Strength",
"Potion of Gaseous Form",
"Potion of Heroism",
"Potion of Beast Mind Control",
"Potion of Mind Reading",
"Potion of Superior Healing",
"Quaals Feather Token (anchor, bird, fan, swan boat, tree, whip",
"Scroll of Protection, any",
"Scroll 4th level spell",
"Scroll 5th level spell",
"Amulet of Health",
"Bag of Beans",
"Bowl of Commanding Water Elementals",
"Brazier of commanding fire elementals",
"Censer of controlling air elementals",
"Chime of opening",
"Cube of Force",
"Daerns instant fortress",
"Dagger of Venom",
"Dimensional Shackles",
"Eagle Whistle",
"Figuring of Wonderous Power (griffon, Fly, Lion, Goat, Elephant, Dog, Owl)",
"Gavel of the venn rune",
"Gem of Seeing",
"Horn of Blasting",
"Horn of Valhalla Brass",
"Horn of Valhalla silver",
"Horseshoes of speed",
"Ion stone (awareness, protection, reserve, sustenance)",
"Loadstone",
"Opal of the ild rune",
"Orb of the stein rune",
"Periapt of Proof against poison",
"Portable Hole",
"Ring of animal influence",
"Ring of Evasion",
"Ring of Feather Falling",
"Ring of Free Action",
"Ring of Protection",
"Ring of resistance",
"Necklace of Prayer beads (bless, cure, favor, smiting, summons)",
"Ring of spell storing",
"Ring of the ram",
"Ring of x-ray vision",
"Spell Gem Quartz",
"Spell Gem Bloodstone",
"Stone speaker crystal",
"Stone of controlling earth elementals",
"Wand of Binding",
"Wand of enemy detection",
"Wand of Fear",
"Wand of fireballs",
"Wand of lightning bolts",
"Wand of paralysis",
"Wand of the War Mage +2",
"Wand of viscid globes",
"Wand of Winter",
"Wand of Wonder"
				]

			max=itemList.length;

			index=rand(0,max);

			rewardItem=itemList[index];

			return rewardItem;

		}


		function rewardVeryRare() {
			var itemList = [
"Candle of Invocation",
"Nolzur's marvelous pigments",
"Potion of Flying",
"Potion of Cloud Giant strength",
"Potion of Invisibility",
"Potion of speed",
"Potion of Supreme Healing",
"Potion of Vitality",
"Spell Scroll 6th level",
"Spell Scroll 7th level",
"Spell Scroll 8th level",
"Crystal Ball",
"Devastation Orb",
"Efreeti Bottle",
"Figuring of wonderous power Obsidian steed",
"Horn of Valhalla Bronze",
"Ingot of the skold rune",
"Ion stone (absorption, agility, fortitude, insight, intellect, leadership, strength)",
"Manual of Golems",
"Ring of Shooting Stars",
"Shard of the vind rune",
"Spell Gem Amber",
"Spell Gem Jade",
"Spell Gem Topaz",
"Wand of Polymorph"
				]

			max=itemList.length;

			index=rand(0,max);

			rewardItem=itemList[index];

			return rewardItem;

		}


		function buildTarget(reward) {
			var targetList= [
						"Enter Roll Above",
						"9 or less - Townsfolk - 1d10 gp per day",
						"10 - Merchants/Tier 1 adventurers - 1d20 gp per day and 5% chance of a special common item",
						"15 - Rich Merchants/Tier 2 adventurers - 2d20 gp per day and 5% chance of special item (60% common, 40% uncommon)",
						"20 - Nobles/Tier 3 adventurers - 2d100 gp per day and 10% chance of special item (50% common, 30% uncommon, 20% rare)",
						"25 - Rich Nobles/Tier 4 adventurers - 200 gp per day and 10% chance of special item (40% common, 30% uncommon, 20% rare, 10% very rare)"
				];
			var victim = document.getElementById("target");

			while (victim.hasChildNodes()) {
 				victim.removeChild(victim.firstChild);
			}

			for (var i = 0; i<=reward; i++){
			    var opt = document.createElement('option');
			    opt.innerHTML = targetList[i];
			    victim.appendChild(opt);
			}
		}


		function main () {
			document.getElementById("investigation").value = rand(6,26);
			document.getElementById("sleightOfHand").value = rand(8,28);
			document.getElementById("stealthDeception").value = rand(10,29);

			var investigationRoll = document.getElementById("investigation").value;
			var victim = document.getElementById("target");
			var sleightOfHandRoll = document.getElementById("sleightOfHand").value;
			var stealthDeceptionRoll = document.getElementById("stealthDeception").value;
			var lawMod = document.getElementById("law").value;
			var guildMod = document.getElementById("guild").value;
			var daysMod = document.getElementById("days").value;

			var targetDC = 0;
			var reward = 0;
			var complication = false;
			var gold=0;
			var item="";
			var compMod = 0;

			compMod=compMod+lawMod+guildMod+(daysMod*5);

			console.log(compMod);

			switch(true) {
  				case investigationRoll == 0:
				    // Do Nothing
			    	break;
  				case investigationRoll<=9 && investigationRoll>0:
			    	targetDC = investigationRoll;
			    	reward = 1;
			    	buildTarget(reward);
			    	victim.options[1].selected = true;
			    	compMod=compMod-10;
    				break;
  				case investigationRoll<15 && investigationRoll>9:
			    	targetDC = 10;
			    	reward = 2;
			    	buildTarget(reward);
			    	victim.options[2].selected = true;
			    	compMod=compMod-5;
    				break;
  				case investigationRoll<20 && investigationRoll>=15:
			    	targetDC = 15;
			    	reward = 3;
			    	buildTarget(reward);
			    	victim.options[3].selected = true;
    				break;
  				case investigationRoll<25 && investigationRoll>=20:
			    	targetDC = 20;
			    	reward = 4;
			    	buildTarget(reward);
			    	victim.options[4].selected = true;
			    	compMod=compMod+5;
    				break;
  				case investigationRoll>=25:
			    	targetDC = 25;
			    	reward = 5;
			    	buildTarget(reward);
			    	victim.options[5].selected = true;
			    	compMod=compMod+10;
    				break;
    			default:
    				break;
			}

			if (sleightOfHandRoll > 0) {
				if (sleightOfHandRoll >= targetDC) {
					itemChanceRoll=rand(1,100);
					rarityRoll=rand(1,100);
					switch (reward) {
						case 1:
							gold=rand(1,10);
							break;
						case 2:
							gold=rand(1,20);
							if (itemChanceRoll<=5) { 
								item = rewardCommon();
							}
							break;
						case 3:
							gold=rand(2,40);
							if (itemChanceRoll<=5) { 
								if (rarityRoll>60) {
									item = rewardUncommon();
								} else {
									item = rewardCommon();
								}
							}
							break;
						case 4:
							gold=rand(2,200);
							if (itemChanceRoll<=10) { 
								if (rarityRoll>80) {
									item = rewardRare();
									compMod=compMod+5;									
								} else if (rarityRoll>50) {
									item = rewardUncommon();
								} else {
									item = rewardCommon();
								}
							}
							break;
						case 5:
							gold=200;
							if (itemChanceRoll<=10) { 
								if (rarityRoll>90) {
									item = rewardVeryRare();
									compMod=compMod+10;
								} else if (rarityRoll>70) {
									item = rewardRare();
									compMod=compMod+5;
								} else if (rarityRoll>40) {
									item = rewardUncommon();
								} else {
									item = rewardCommon();
								}
							}
							break;
					}

					if (item!="") {
						document.getElementById("result").value = "Success - "+gold+"gp, "+item;
					} else {
						document.getElementById("result").value = "Success - "+gold+"gp";
					}

				} else {
					document.getElementById("result").value = "Failed to Pickpocket!";
				}
			}


			document.getElementById("escapeDC").value = compMod;

			if (stealthDeceptionRoll>=compMod) {
					document.getElementById("escape").value = "Escaped with no Complications.";

			} else {

					whatHappened=complications();

					document.getElementById("escape").value = "Complications! - "+whatHappened;
			}
		}
		

		function playSafe() {
			var index = document.getElementById("target").selectedIndex;

			switch(index) {
				case 1:
					document.getElementById("investigation").value = 9;
					break;
				case 2:
					document.getElementById("investigation").value = 10;
					break;
				case 3:
					document.getElementById("investigation").value = 15;
					break;
				case 4:
					document.getElementById("investigation").value = 20;
					break;
				case 5:
					document.getElementById("investigation").value = 25;
					break;
			}
		}







	</script>
</head>
<body OnLoad='main()'>
	<h1>Pickpocketing Calculator a24</h1>
		<form>
		<table>
			<tr>
				<th>Lawfulness of city or neighborhood</th>
				<td>
					<select id='law'>
						<option value='-10'>Lawless</option>
						<option value='10' selected>Secured</option>
					</select>
				</td>
			</tr>
			<tr>
				<th>Strength and influence of local Thieves Guild</th>
				<td>
					<select id='guild'>
						<option value='-5'>None</option>
						<option value='5' selected>Strong</option>
					</select>
				</td>
			</tr>
			<tr>
				<th>How many days previously did pickpocketing?</th>
				<td>
					<input type=text id='days' value='0' size=2>
				</td>
			</tr>

			<tr>
				<th>Investigation Roll</th>
				<td>
					<input type=text id='investigation' value='0' size=2 OnChange='main()'>
				</td>
			</tr>
			<tr>
				<th>Target</th>
				<td>
					<select id='target' OnChange='playSafe()'>
						<option>Enter Roll Above</option>
					</select>
				</td>
			</tr>
			<tr>
				<th>Sleight of Hand Roll</th>
				<td>
					<input type=text id='sleightOfHand' value='0' size=2 OnChange='main()'>

				</td>
			</tr>		
			<tr>
				<th>Result</th>
				<td>
					<input type=text id='result' size=100 value='' readonly>
				</td>
			</tr>		
			<tr>
				<th>Stealth/Deception Roll for Escape</th>
				<td>
					<input type=text id='stealthDeception' value='0' size=2 OnChange='main()'>

				</td>
			</tr>		
			<tr>
				<th>Escape DC</th>
				<td>
					<input type=text id='escapeDC' size=10 value='0' readonly>
				</td>
			</tr>		
			<tr>
				<th>Escape Complication</th>
				<td>
					<input type=text id='escape' size=100 value='' readonly>
				</td>
			</tr>		


		</table>
		<button onclick='main()'>Reset</button>
	</form>
</body>
</html>
